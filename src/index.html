<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>Key Font Helper</title>
<link rel="stylesheet" href="https://cwh.ca510.com/key-font/key_font.css">
<link rel="stylesheet" href="https://cwh.ca510.com/1-level-font/table.css">
<div>
    <input id="series-input" type="radio" name="type" value="series" checked>
    <label for="series-input">Series Based</label>
    <input id="font-input" type="radio" name="type" value="font">
    <label for="font-input">Font Based</label>
</div>
<div id="series-panel">
    <label for="series"></label><select id="series"></select>
</div>
<div id="font-panel" style="display: none;">
    <label for="keyName"></label><select id="keyName"></select>
</div>
<div>
    <label for="text"></label><textarea id="text"></textarea>
</div>
<div>
    <div id="result"></div>
</div>
<div>
    <div id="mapping"></div>
</div>
<script>
  const keyName = document.getElementById('keyName');
  const series = document.getElementById('series');
  const text = document.getElementById('text');
  const result = document.getElementById('result');
  const mapping = document.getElementById('mapping');

  const ascii = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "!", "$", "\"", "'", "%", "&", "(", ")", "*", "+", ".", ",", "-", "/", "=", "^", "~", "#", "{", "<", ">", "?", "@", "[", "}", "]", ":", ";", "_", "`", "|", "\\"];

  window.addEventListener('load', function () {
    kfh.config.forEach((kf) => {
      const option = document.createElement('option');
      option.value = kf.keyName;
      option.innerText = kf.fontName;
      keyName.appendChild(option);
    });
    mapping.innerHTML = `<div class="table-container"><table class="table-view"><thead>
<tr>
<th>ASCII</th>
${kfh.config.map(v => `<th colspan="2">${v.fontName.replace('CASIO ', '')}</th>`).join('')}
</tr></thead>
<tbody>
${ascii.map(a => `<tr><td>${a}</td>${kfh.config.map(v => `<td class="${v.keyName}">${a}</td><td>${v.keyMapping[a]?.join('<br>') ?? ''}</td>`).join('')}</tr>`).join('')}
</tbody>
</div>`;
    kfh.series.forEach((s) => {
      const option = document.createElement('option');
      option.value = s;
      option.innerText = s;
      series.appendChild(option);
    })
  });

  keyName.onchange = series.onchange = text.oninput = function () {
    const type = document.querySelector('input[name="type"]:checked').value;
    if (type === 'series') {
      result.innerHTML = kfh.text2KeyFontBySeries(series.value, text.value);
    } else if (type === 'font') {
      result.innerHTML = kfh.text2KeyFont(keyName.value, text.value);
    }
  }

  document.querySelectorAll('input[name="type"]').forEach(radio => {
    radio.addEventListener('change', function () {
      document.querySelectorAll('[id$="-panel"]').forEach(panel => {
        panel.style.display = 'none';
      });

      if (this.checked) {
        document.getElementById(`${this.value}-panel`).style.display = 'block';
      }
      text.oninput(null);
    });
  });
</script>
</html>
